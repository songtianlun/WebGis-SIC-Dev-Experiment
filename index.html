<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title >WebGis实验室</title>

    <!--引用需要的脚本-->
    <script src="./libs/SuperMap.Include.js"></script>
    <link href='./css/bootstrap.min.css' rel='stylesheet' />
    <link href='./css/bootstrap-responsive.min.css' rel='stylesheet' />

    <script src="./js/mdui.min.js"></script>
    <link rel="stylesheet" href="./css/mdui.min.css">
    <style type="text/css">
        .dialog-content {
            padding: 30px;
        }
        html,body{
            height: 100%;
            margin: 0;
            padding: 0;
        }
        #content-drawer {
            padding: 20px;
            /*background: skyblue;*/
            /*font-size: 50px;*/
            /*color:#fff;*/
        }
        #content-main {
            padding: 20px;
            width: 100%;
            height:90%;
            background: black;
            /*font-size: 50px;*/
            /*color:#fff;*/
        }

        #content-footer {
            padding: 30px;
            /*height:10%;*/
        }

        #map {
            width: 100%;
            height: 100%;
        }
    </style>
    <script type="text/javascript">

        let provincename;
        var map, layer,vectorLayer, markerLayer, features, select , delIndex = 0,
            linewordvectorLayer,control,drawPoint,drawPolygon, polygonLayer,bufferdrawPoint, bufferdrawLine, bufferdrawPolygon,
            EMvectorLayer, EMdrawPoint, EMdrawPolygon, dataUrl, ids, modifyFeature,
            //设置图层样式
            drawlinestyle = {
                strokeColor: "#304DBE",
                strokeWidth: 2,
                pointerEvents: "visiblePainted",
                fillColor: "#304DBE",
                fillOpacity: 0.8
            },
            Polyonstyle = {
                strokeColor: "#304DBE",
                strokeWidth: 2,
                pointerEvents: "visiblePainted",
                fillColor: "#304DBE",
                fillOpacity: 0.8
            },
            drawstyle = {
                strokeColor: "#304DBE",
                strokeWidth: 1,
                pointerEvents: "visiblePainted",
                fillColor: "#304DBE",
                fillOpacity: 0.5
            },
            bufferstyle = {
                strokeColor: "#304DBE",
                strokeWidth: 1,
                pointerEvents: "visiblePainted",
                fillColor: "#304DBE",
                fillOpacity: 0.5,
                pointRadius:2
            },
            EMstyle = {
                strokeColor: "#304DBE",
                strokeWidth: 1,
                pointerEvents: "visiblePainted",
                fillColor: "#304DBE",
                fillOpacity: 0.8,
                pointRadius:2
            },
            drawpointstyle = {
                strokeColor: "#304DBE",
                strokeWidth: 1,
                pointerEvents: "visiblePainted",
                fillColor: "#304DBE",
                fillOpacity: 0.5
            },
            host = "https://iserver.supermap.io",
                // document.location.toString().match(/file:\/\//) ? "http://114.116.67.239:8090" : 'http://' + document.location.host;
        url = host + "/iserver/services/map-China/rest/maps/China",
        url2 = host+"/iserver/services/data-China/rest/data",
        url3 = host+"/iserver/services/map-jingjin/rest/maps/京津地区土地利用现状图",
        url4 = host+"/iserver/services/data-jingjin/rest/data/datasources/name/Jingjin/datasets/name/Landuse_R/",
        url5 = host+"/iserver/services/data-jingjin/rest/data/";
        url6 = host+"/iserver/services/data-China/rest/data/datasources/name/privances/datasets/name/省界_region/";
        function init(){
            //新建面矢量图层
            polygonLayer = new SuperMap.Layer.Vector("polygonLayer");
            //对面图层应用样式style（前面有定义）
            polygonLayer.style = Polyonstyle;
            /*
            注册featureadded事件,触发drawCompleted()方法
            例如注册"loadstart"事件的单独监听
            events.on({ "loadstart": loadStartListener });
            */
            //创建画面控制，图层是polygonLayer
            drawPolygon = new SuperMap.Control.DrawFeature(polygonLayer, SuperMap.Handler.Polygon);
            drawPolygon.events.on({"featureadded": drawCompleted});

            //标记图层
            markerLayer = new SuperMap.Layer.Markers("查询结果Marker");

            //距离量算1
            //存储文字 最终线样式 删除按钮 动态绘制过程中保存的内容
            linewordvectorLayer = new SuperMap.Layer.Vector("距离量测点和文字");
            vectorLayerLine = new SuperMap.Layer.Vector("距离量测-线");
            vectorLayerX = new SuperMap.Layer.Vector("距离量测-删除");
            vectorLayerTmp = new SuperMap.Layer.Vector("距离量测-临时");


            //几何查询绘制图形
            vectorLayer = new SuperMap.Layer.Vector("几何查询图形");

            //地物编辑图层
            EMvectorLayer = new SuperMap.Layer.Vector("Vector Layer");
            EMvectorLayer.events.on({"afterfeaturemodified": editFeatureCompleted});
            modifyFeature = new SuperMap.Control.ModifyFeature(EMvectorLayer);

            EMdrawPoint = new SuperMap.Control.DrawFeature(EMvectorLayer, SuperMap.Handler.Point);
            EMdrawPoint.events.on({"featureadded": selectedFeatureCompleted});

            EMdrawPolygon = new SuperMap.Control.DrawFeature(EMvectorLayer, SuperMap.Handler.Polygon);
            EMdrawPolygon.events.on({"featureadded": addFeatureCompleted});

            //点查询
            drawPoint = new SuperMap.Control.DrawFeature(vectorLayer, SuperMap.Handler.Point);
            drawPoint.events.on({"featureadded": drawPointCompleted});
            //矩形
            drawRectangle = new SuperMap.Control.DrawFeature(vectorLayer, SuperMap.Handler.Box);
            drawRectangle.events.on({"featureadded": drawRectangleCompleted});

            //几何圆查询
            drawPolygon1 = new SuperMap.Control.DrawFeature(vectorLayer, SuperMap.Handler.RegularPolygon,{handlerOptions:{sides:50}});
            drawPolygon1.events.on({"featureadded": drawPolygonCompleted});

            //多边形查询
            drawPolygon2 = new SuperMap.Control.DrawFeature(vectorLayer, SuperMap.Handler.Polygon);
            drawPolygon2.events.on({"featureadded": drawPolygonCompleted});

            //缓冲区查询（点）
            bufferdrawPoint = new SuperMap.Control.DrawFeature(vectorLayer, SuperMap.Handler.Point);
            bufferdrawPoint.events.on({"featureadded": bufferdrawCompleted});
            //线
            bufferdrawLine = new SuperMap.Control.DrawFeature(vectorLayer, SuperMap.Handler.Path);
            bufferdrawLine.events.on({"featureadded": bufferdrawCompleted})
            //面
            bufferdrawPolygon = new SuperMap.Control.DrawFeature(vectorLayer, SuperMap.Handler.Polygon);
            bufferdrawPolygon.events.on({"featureadded": bufferdrawCompleted});

            //初始化地图
            map = new SuperMap.Map("map",{controls: [
                    new SuperMap.Control.LayerSwitcher(),
                    new SuperMap.Control.ScaleLine(),
                    // new SuperMap.Control.Zoom(),
                    new SuperMap.Control.Navigation({
                        dragPanOptions: {
                            enableKinetic: true
                        }
                    }),bufferdrawPoint, bufferdrawLine, bufferdrawPolygon,drawPolygon1,drawPolygon2,drawRectangle,drawPoint,drawPolygon,EMdrawPoint, EMdrawPolygon], allOverlays: true,units: "m"
            });
            map.addControl(new SuperMap.Control.MousePosition());
            map.addControl(modifyFeature);//地图编辑使用
            //初始化图层
            layer = new SuperMap.Layer.TiledDynamicRESTLayer("China", url, { transparent: true, cacheEnabled: true },{maxResolution:"auto"});
            //监听图层信息加载完成事件
            layer.events.on({"layerInitialized":addLayer1});

            //初始化复杂缩放控件类
            panzoombar=new SuperMap.Control.PanZoomBar();
            // 是否固定缩放级别为[0,16]之间的整数，默认为false
            panzoombar.forceFixedZoomLevel=true;
            //是否显示滑动条，默认值为false
            panzoombar.showSlider=true;
            /*点击箭头移动地图时，所移动的距离占总距离（上下移动的总距离为高度，左右移动的总距离为宽度）
            的百分比，默认为null。 例如：如果slideRatio 设为0.5, 则垂直上移地图半个地图高度.*/
            panzoombar.slideRatio=0.5;
            //设置缩放条滑块的高度，默认为120
            panzoombar.sliderBarHeight=180;
            //设置缩放条滑块的宽度，默认为13
            panzoombar.sliderBarWidth=17;
            map.addControl(panzoombar);
            // layerWorld = new SuperMap.Layer.TiledDynamicRESTLayer("World", url, { transparent: true, cacheEnabled: true }, { maxResolution: "auto" }); //获取图层服务地址
            // layerWorld.events.on({"layerInitialized": addLayer});

            //初始化鹰眼控件类
            // overviewmap = new SuperMap.Control.OverviewMap();
            // //属性minRectSize：鹰眼范围矩形边框的最小的宽度和高度。默认为8pixels
            // overviewmap.minRectSize = 20;
            // layerWorld = new SuperMap.Layer.TiledDynamicRESTLayer("World", url); //获取图层服务地址
            // layerWorld.events.on({"layerInitialized": addLayer});

            //距离量算2
            //添加删除事件
            select = new SuperMap.Control.SelectFeature(vectorLayerX, {onSelect: onFeatureSelect});
            //激活删除事件
            map.addControl(select);



        }
        //异步加载图层
        function addLayer(){
            map.addLayers([layer,markerLayer,vectorLayerLine,linewordvectorLayer,vectorLayerTmp,vectorLayerX,polygonLayer,vectorLayer,layerJingjing,EMvectorLayer]);
            //加载鹰眼图
            // map.addControl(overviewmap);
            map.setCenter(new SuperMap.LonLat(118, 40), 6);
            map.addControl(new SuperMap.Control.MousePosition()) ;

            measureControls = {
                //距离量算
                line:new SuperMap.Control.Measure(
                    SuperMap.Handler.Path, {immediate:true}
                )
            };
            //监听 measure 和 measurepartial 两个事件，量算完成时触发时
            //量算完成时触发 measure 事件，当点被添加到量算过程中时触发 measurepartial
            for(var key in measureControls){
                control = measureControls[key];
                control.events.on({
                    "measure": handleMeasure,
                    "measurepartial": handleMeasurements
                });
                //添加控件到 map 上
                map.addControl(control);
            }

        }
        function addLayer1(){
            layerJingjing = new SuperMap.Layer.TiledDynamicRESTLayer("京津地区地图", url3, {transparent: true, cacheEnabled: true});
            layerJingjing.events.on({"layerInitialized": addLayer});
            //layerJingjing.setOpacity(0.6);
        }

        //SQL查询
        function queryBySQL() {
            clearFeatures();
            delIndex =0;
            provincename= document.getElementById("provincename").value; //获取文本框内容

            if(provincename){
                //根据输入内容查询
                var queryParamCapital, queryBySQLParamsCapital, queryBySQLServiceCapital;
                var provincenameSql ="NAME like '%"+provincename+"%'";
                //初始化查询参数
                queryParamCapital = new SuperMap.REST.FilterParameter({
                    name: "省会_font_point@privances",
                    attributeFilter:  provincenameSql
                }),
                    //初始化sql查询参数
                    queryBySQLParamsCapital = new SuperMap.REST.QueryBySQLParameters({
                        queryParams: [queryParamCapital]
                    }),
                    //SQL查询服务
                    queryBySQLServiceCapital = new SuperMap.REST.QueryBySQLService(url, {
                        eventListeners: {"processCompleted": processCompletedCapital, "processFailed": processFailedCapital}});
                queryBySQLServiceCapital.processAsync(queryBySQLParamsCapital);
            }else{
                //查询中国的全部省会。
                var queryParamCapital, queryBySQLParamsCapital, queryBySQLServiceCapital;
                //初始化查询参数
                queryParamCapital = new SuperMap.REST.FilterParameter({
                    name: "省会_font_point@privances",
                    attributeFilter: "SmID > 0"
                }),
                    //初始化sql查询参数
                    queryBySQLParamsCapital = new SuperMap.REST.QueryBySQLParameters({
                        queryParams: [queryParamCapital]
                    }),
                    //SQL查询服务
                    queryBySQLServiceCapital = new SuperMap.REST.QueryBySQLService(url, {
                        eventListeners: {"processCompleted": processCompletedCapital, "processFailed": processFailedCapital}});
                queryBySQLServiceCapital.processAsync(queryBySQLParamsCapital);
            }

        }

        //SQL查询(省会)成功时触发此事件
        function processCompletedCapital(queryEventArgs) {
            var i, j, feature,
                result = queryEventArgs.result;
            if (result.currentCount<1){
                alert("关键字：["+provincename+"]  查询结果为空!");
            }else{
                alert("查询结果总个数："+result.currentCount);
                features = [];
                if (result && result.recordsets) {
                    for (i=0; i<result.recordsets.length; i++) {
                        if (result.recordsets[i].features) {
                            for (j=0; j<result.recordsets[i].features.length; j++) {

                                var point = result.recordsets[i].features[j].geometry,
                                    size = new SuperMap.Size(44, 33),
                                    offset = new SuperMap.Pixel(-(size.w/2), -size.h),
                                    icon = new SuperMap.Icon("./theme/images/marker.png", size, offset);
                                var marker = new SuperMap.Marker(new SuperMap.LonLat(point.x, point.y), icon)
                                marker.sm_capital = result.recordsets[i].features[j].attributes.NAME;
                                marker.sm_province = result.recordsets[i].features[j].attributes.Province;
                                marker.sm_prefecture = result.recordsets[i].features[j].attributes.Prefecture;
                                marker.sm_gdp = result.recordsets[i].features[j].attributes.GDP;
                                marker.events.on({
                                    "mousemove":openInfoWin,
                                    "mouseout":closeInfoWin,
                                    "click":openInfoWinDetail,
                                    "touchstart":openInfoWin, //假如要在移动端的浏览器也实现点击弹框，则在注册touch类事件
                                    "scope": marker
                                });
                                markerLayer.addMarker(marker);
                            }
                        }
                    }
                }
            }

        }

        //鼠标移动事件执行
        var infowin = null;
        function openInfoWin(){
            closeInfoWin();
            var marker = this;
            var lonlat = marker.getLonLat();
            var contentHTML = "<div style='font-size:.8em; opacity: 0.8; overflow-y:hidden;'>";
            contentHTML += "<div>"+marker.sm_capital+"</div></div>";
            var size = new SuperMap.Size(0, 33);
            var offset = new SuperMap.Pixel(0, -size.h);
            var icon = new SuperMap.Icon("./theme/images/marker.png", size, offset);
            var popup = new SuperMap.Popup.FramedCloud("popwin",
                new SuperMap.LonLat(lonlat.lon,lonlat.lat),
                null,
                contentHTML,
                icon,
                true);

            infowin = popup;
            map.addPopup(popup);
        }
        //鼠标单击事件执行
        var infowindetail = null;
        function openInfoWinDetail(){
            closeInfoWinDetail();
            var marker = this;
            var lonlat = marker.getLonLat();
            var DetailMesasage = "详细信息 </br>" +
                "名称："+marker.sm_capital+"</br>" +
                "经度："+lonlat.lon+"</br>" +
                "纬度："+lonlat.lat+"</br>" +
                "省份："+marker.sm_province+"</br>" +
                "地级市："+marker.sm_prefecture+"个</br>" +
                "GDP："+marker.sm_gdp+"</br>";
            if(marker.sm_gdp==-1){
                DetailMesasage+="该地区经济数据暂缺";
            }
            var contentHTML = "<div style='font-size:.8em; opacity: 0.8; overflow-y:hidden;'>";
            contentHTML += "<div>"+DetailMesasage+"</div></div>";
            var size = new SuperMap.Size(0, 33);
            var offset = new SuperMap.Pixel(0, -size.h);
            var icon = new SuperMap.Icon("./theme/images/marker.png", size, offset);
            var popup = new SuperMap.Popup.FramedCloud("popwin",
                new SuperMap.LonLat(lonlat.lon,lonlat.lat),
                null,
                contentHTML,
                icon,
                true);

            infowindetail = popup;
            map.addPopup(popup);
        }
        //关闭鼠标移动执行弹框
        function closeInfoWin(){
            if(infowin){
                try{
                    infowin.hide();
                    infowin.destroy();
                }
                catch(e){}
            }
        }
        //关闭鼠标单击事件执行弹框
        function closeInfoWinDetail(){
            if(infowindetail){
                try{
                    infowindetail.hide();
                    infowindetail.destroy();
                }
                catch(e){}
            }
        }
        //SQL查询(省会)失败时出发的事件
        function processFailedCapital(e) {
            alert(e.error.errorMsg);
        }

        //清除查询元素
        function clearFeatures() {
            // if(vectorLayer.selectedFeatures.length > 0) {
            //     map.removePopup(vectorLayer.selectedFeatures[0].popup);
            // }
            // vectorLayer.removeAllFeatures();
            markerLayer.clearMarkers();
            closeInfoWin();
            closeInfoWinDetail();

            //清除距离量算图层
            linewordvectorLayer.removeAllFeatures();
            vectorLayerLine.removeAllFeatures();
            vectorLayerX.removeAllFeatures();
            select.deactivate();

            //清除面积量算图层
            polygonLayer.removeAllFeatures();
            if(areameasureinfowin){
                try{
                    areameasureinfowin.hide();
                    areameasureinfowin.destroy();
                }
                catch(e){}
            }

            //清除几何查询绘图图层
            vectorLayer.removeAllFeatures();

        }

        //距离量算
        function LineMeasure() {
            clearFeatures();
            linewordvectorLayer.removeAllFeatures();
            vectorLayerLine.removeAllFeatures();
            vectorLayerTmp.removeAllFeatures();
            vectorLayerX.removeAllFeatures();
            control.activate();
        }

        //点击删除量算按钮
        function onFeatureSelect(feature) {
            linewordvectorLayer.removeAllFeatures();
            vectorLayerLine.removeAllFeatures();
            vectorLayerX.removeAllFeatures();
            select.deactivate();
        }

        //最终双击结束
        function handleMeasure(event) {
            control.deactivate();
            vectorLayerTmp.removeAllFeatures();
            //获取当前坐标点
            var pointStart = new SuperMap.Geometry.Point(event.geometry.components[(event.geometry.components.length-1)].x,event.geometry.components[(event.geometry.components.length-1)].y);
            //克隆坐标点 用于显示关闭按钮
            var pointCopy = pointStart.clone();

            //单位转换
            var unitString = "";
            if(event.units == "m") {
                unitString = "米";
            }else if(event.units == "km") {
                unitString = "公里";
            }else{
                unitString = "";
            }

            var f = new SuperMap.Feature.Vector;
            f.geometry = pointStart;
            f.style= {label:"总长：" + event.measure.toFixed(1)+unitString,
                fontColor:'red',
                strokeColor: "red",
                strokeOpacity: 1,
                fillColor: "#ffffff",
                labelXOffset:20,
                labelYOffset:20,
                pointRadius: 4};
            //删除按钮
            var fc = new SuperMap.Feature.Vector;
            fc.geometry = pointCopy;
            fc.style= {
                externalGraphic: "./images/Error.png",
                strokeColor: "red",
                graphicWidth:16,
                graphicHeight:16,
                strokeOpacity: 1,
                fillColor: "#ffffff",
                graphicXOffset:10,
                pointRadius: 4};
            //保存之前绘制的节点用于显示其他样式
            var points = [];
            for(var i = 0;i < event.geometry.components.length; i++) {
                points.push(new SuperMap.Geometry.Point(event.geometry.components[i].x, event.geometry.components[i].y));
            }
            var qu = new SuperMap.Geometry.LineString(points);
            //保留线样式
            var ff = new SuperMap.Feature.Vector;
            ff.geometry = qu;
            ff.style = {
                strokeColor: "#FC854D",
                strokeWidth: 2.5,
                pointerEvents: "visiblePainted",
                fillColor: "#FC854D",
                fillOpacity: 1};
            vectorLayerLine.addFeatures(ff);
            linewordvectorLayer.addFeatures(f);
            vectorLayerX.addFeatures(fc);

            //激活选择要素的控件
            select.activate();
        }
        //绘制过程中单机和移动事件
        function handleMeasurements(event) {
            //获取传入参数 event 的 geometry 信息
            var geometry = event.geometry;
        // <!-- //获取传入参数 event 的 type 信息（click指示的是点击事件，move指示的是移动事件） -->
            var type=event.type;
            //单位转换
            var unitString = "";
            if(event.units == "m") {
                unitString = "米";
            }else if(event.units == "km") {
                unitString = "公里";
            }else{
                unitString = "";
            }

            if(type == 'click') {
                //当==2时为起点
                if(event.geometry.components.length == 2) {
                    var pointStart = new SuperMap.Geometry.Point(event.geometry.components[(event.geometry.components.length-1)].x,event.geometry.components[0].y);
                    var f = new SuperMap.Feature.Vector;
                    f.geometry = pointStart;
                    f.style= {
                        label:'起点',
                        fontColor:'red',
                        strokeColor: "red",
                        strokeOpacity: 1,
                        fillColor: "#ffffff",
                        labelXOffset:20,
                        labelYOffset:20,
                        pointRadius: 4};
                    linewordvectorLayer.addFeatures(f);
                }else {
                    //单机节点
                    var pointStart = new SuperMap.Geometry.Point(event.geometry.components[(event.geometry.components.length-1)].x,event.geometry.components[(event.geometry.components.length-1)].y);
                    var f = new SuperMap.Feature.Vector;
                    f.geometry = pointStart;
                    f.style= {
                        label: + event.measure.toFixed(1)+unitString,
                        fontColor:'red',
                        strokeColor: "red",
                        strokeOpacity: 1,
                        fillColor: "#ffffff",
                        labelXOffset:20,
                        labelYOffset:20,
                        pointRadius: 4};
                    linewordvectorLayer.addFeatures(f);
                }
            }else {
                //临时显示点信息
                vectorLayerTmp.removeAllFeatures();
                var pointStart = new SuperMap.Geometry.Point(event.geometry.components[(event.geometry.components.length-1)].x,event.geometry.components[(event.geometry.components.length-1)].y);
                var f = new SuperMap.Feature.Vector;
                f.geometry = pointStart;
                f.style= {
                    label: + event.measure.toFixed(1)+unitString,
                    fontColor:'red',
                    strokeColor: "red",
                    strokeOpacity: 1,
                    fillColor: "#ffffff",
                    labelXOffset:20,
                    labelYOffset:20,
                    pointRadius: 4};
                vectorLayerTmp.addFeatures(f);
            }
        }

        function areaMeasure(){
            clearFeatures();
            drawPolygon.activate();
        }

        var areameasuredrawpoint;
        //绘完触发事件
        function drawCompleted(drawGeometryArgs) {
            //停止画面控制
            drawPolygon.deactivate();
            //获得图层几何对象
            var geometry = drawGeometryArgs.feature.geometry,
                measureParam = new SuperMap.REST.MeasureParameters(geometry), /* MeasureParameters：量算参数类。 客户端要量算的地物间的距离或某个区域的面积*/
                myMeasuerService = new SuperMap.REST.MeasureService(url); //量算服务类，该类负责将量算参数传递到服务端，并获取服务端返回的量算结果
            myMeasuerService.events.on({ "processCompleted": measureCompleted });

            //获取绘制图形几何中心
            areameasuredrawpoint = geometry.getCentroid();
            //console.log("中心："+areameasuredrawpoint.x+","+areameasuredrawpoint.y);

            //对MeasureService类型进行判断和赋值，当判断出是LineString时设置MeasureMode.DISTANCE，否则是MeasureMode.AREA
            myMeasuerService.measureMode = SuperMap.REST.MeasureMode.AREA;
            myMeasuerService.processAsync(measureParam); //processAsync负责将客户端的量算参数传递到服务端。
        }

        //测量结束调用事件
        var areameasureinfowin = null;
        function measureCompleted(measureEventArgs) {
            var area = measureEventArgs.result.area,
                unit = measureEventArgs.result.unit;
            //alert("量算结果:"+ area + "平方米");
            var measureinfo = "面积量算结果：";
            if(area%1000>1){
                measureinfo += area/1000000;
                measureinfo += "平方公里";
            }else{
                measureinfo+=area;
                measureinfo += "平方米";
            }
            areameasurecloseInfoWin();
            var contentHTML = "<div style='font-size:.8em; opacity: 0.8; overflow-y:hidden;'>";
            contentHTML += "<br>"+measureinfo+
                "</div></div>";
            var size = new SuperMap.Size(0, 33);
            var offset = new SuperMap.Pixel(0, -size.h);
            var icon = new SuperMap.Icon("./theme/images/marker.png", size, offset);
            var popup = new SuperMap.Popup.FramedCloud("popwin",
                new SuperMap.LonLat(areameasuredrawpoint.x,areameasuredrawpoint.y),
                null,
                contentHTML,
                icon,
                true);

            areameasureinfowin = popup;
            map.addPopup(popup);
        }
        //关闭弹框
        function areameasurecloseInfoWin(){
            if(areameasureinfowin){
                try{
                    areameasureinfowin.hide();
                    areameasureinfowin.destroy();
                }
                catch(e){}
            }
        }

        //画圆
        function drawGeometry1() {
            //先清除上次的显示结果
            clearFeatures();
            drawPolygon1.activate();
        }
        //画多边形
        function drawGeometry2() {
            //先清除上次的显示结果
            clearFeatures();
            drawPolygon2.activate();
        }
        //画矩形
        function drawGeometry5() {
            //先清除上次的显示结果
            clearFeatures();
            drawRectangle.activate();
        }

        //完成圆和多边形
        function drawPolygonCompleted(drawGeometryArgs) {
            var feature = new SuperMap.Feature.Vector();
            feature.geometry = drawGeometryArgs.feature.geometry,
                feature.style = drawstyle;
            vectorLayer.addFeatures(feature);

            var queryParam, queryByGeometryParameters, queryService;
            queryParam = new SuperMap.REST.FilterParameter({name: "省会_font_point@privances"});
            queryByGeometryParameters = new SuperMap.REST.QueryByGeometryParameters({
                queryParams: [queryParam],
                geometry: drawGeometryArgs.feature.geometry,
                spatialQueryMode: SuperMap.REST.SpatialQueryMode.INTERSECT
            });
            queryService = new SuperMap.REST.QueryByGeometryService(url, {
                eventListeners: {
                    "processCompleted": DrawprocessCompleted,
                    "processFailed": DrawprocessFailed
                }
            });
            queryService.processAsync(queryByGeometryParameters);
        }
        //完成矩形
        function drawRectangleCompleted(obj) {
            drawRectangle.deactivate();
            //先清除上次的显示结果
            clearFeatures();
            var feature = obj.feature;
            feature.style = drawstyle;
            vectorLayer.addFeatures(feature);
            var queryBounds = feature.geometry.bounds;

            var queryParam, queryByBoundsParams, queryService;
            queryParam = new SuperMap.REST.FilterParameter({name: "省会_font_point@privances"});//FilterParameter设置查询条件，name是必设的参数，（图层名称格式：数据集名称@数据源别名）
            queryByBoundsParams = new SuperMap.REST.QueryByBoundsParameters({queryParams: [queryParam], bounds: queryBounds});//queryParams查询过滤条件参数数组。bounds查询范围
            queryService = new SuperMap.REST.QueryByBoundsService(url, {
                eventListeners: {
                    "processCompleted": DrawprocessCompleted,
                    "processFailed": DrawprocessFailed
                }
            });
            queryService.processAsync(queryByBoundsParams);//向服务端传递参数，然后服务端返回对象
        }

        function DrawprocessCompleted(queryEventArgs) {
            drawPolygon1.deactivate();
            drawPolygon2.deactivate();
            drawRectangle.deactivate();
            var i, j, result = queryEventArgs.result;

            if (result.currentCount<1){
                alert("选定区域内无省会级城市!");
                clearFeatures();
            }else{
            if (result && result.recordsets) {
                for (i=0, recordsets=result.recordsets, len=recordsets.length; i<len; i++) {
                    if (recordsets[i].features) {
                        for (j=0; j<recordsets[i].features.length; j++) {
                            var feature = recordsets[i].features[j];
                            var point = feature.geometry;
                            if(point.CLASS_NAME == SuperMap.Geometry.Point.prototype.CLASS_NAME){
                                var size = new SuperMap.Size(44, 33),
                                    offset = new SuperMap.Pixel(-(size.w/2), -size.h),
                                    icon = new SuperMap.Icon("./theme/images/marker.png", size, offset);
                                var marker = new SuperMap.Marker(new SuperMap.LonLat(point.x, point.y), icon)
                                marker.sm_capital = result.recordsets[i].features[j].attributes.NAME;
                                marker.sm_province = result.recordsets[i].features[j].attributes.Province;
                                marker.sm_prefecture = result.recordsets[i].features[j].attributes.Prefecture;
                                marker.sm_gdp = result.recordsets[i].features[j].attributes.GDP;
                                marker.events.on({
                                    "mousemove":openInfoWin,
                                    "mouseout":closeInfoWin,
                                    "click":openInfoWinDetail,
                                    "touchstart":openInfoWin, //假如要在移动端的浏览器也实现点击弹框，则在注册touch类事件
                                    "scope": marker
                                });
                                markerLayer.addMarker(marker);
                            }else{
                                feature.style = drawstyle;
                                vectorLayer1.addFeatures(feature);
                            }

                        }
                    }
                }
            }
            }
        }
        function DrawprocessFailed(e) {
            alert(e.error.errorMsg);
        }

        function bufferdrawPointGeometry() {
            //先清除上次的显示结果
            clearFeatures();

            bufferdrawPoint.activate();
        }
        function bufferdrawLineGeometry() {
            //先清除上次的显示结果
            clearFeatures();

            bufferdrawLine.activate();
        }
        function bufferdrawPolygonGeometry() {
            //先清除上次的显示结果
            clearFeatures();

            bufferdrawPolygon.activate();
        }
        function bufferdrawCompleted(drawGeometryArgs) {
            var bufferdistance;
            buffernum = document.getElementById("buffernum").value; //获取文本框内容
            if(buffernum){
                bufferdistance = buffernum;
            }else{
                bufferdistance = 8;
            }
            bufferdrawPoint.deactivate();
            bufferdrawLine.deactivate();
            bufferdrawPolygon.deactivate();
            var feature = new SuperMap.Feature.Vector();
            feature.geometry = drawGeometryArgs.feature.geometry,
                feature.style = bufferstyle;
            vectorLayer.addFeatures(feature);

            var getFeatureParameter, getFeatureService;
            getFeatureParameter = new SuperMap.REST.GetFeaturesByBufferParameters({
                bufferDistance: bufferdistance,
                //attributeFilter: "SMID > 0",
                datasetNames: ["privances:省会_font_point"],
                returnContent:true,
                geometry: drawGeometryArgs.feature.geometry
            });
            getFeatureService = new SuperMap.REST.GetFeaturesByBufferService(url2, {
                eventListeners: {
                    "processCompleted": bufferprocessCompleted,
                    "processFailed": bufferprocessFailed
                }
            });
            getFeatureService.processAsync(getFeatureParameter);
        }

        function bufferprocessCompleted(getFeaturesEventArgs) {
            var i, len, features, result = getFeaturesEventArgs.result;
            if (result.features.length<1){
                alert("绘制图形缓冲区域内无省会级级城市!");
                clearFeatures();
            }else {
                if (result && result.features) {
                    features = result.features;
                    for (i = 0, len = features.length; i < len; i++) {
                        var point = features[i].geometry,
                            size = new SuperMap.Size(44, 33),
                            offset = new SuperMap.Pixel(-(size.w / 2), -size.h),
                            icon = new SuperMap.Icon("./theme/images/marker.png", size, offset);
                        var marker = new SuperMap.Marker(new SuperMap.LonLat(point.x, point.y), icon)
                        result.features.constructor
                        marker.sm_capital = features[i].attributes.NAME;
                        marker.sm_province = features[i].attributes.Province;
                        marker.sm_prefecture = features[i].attributes.Prefecture;
                        marker.sm_gdp = features[i].attributes.GDP;
                        marker.events.on({
                            "mousemove": openInfoWin,
                            "mouseout": closeInfoWin,
                            "click": openInfoWinDetail,
                            "touchstart": openInfoWin, //假如要在移动端的浏览器也实现点击弹框，则在注册touch类事件
                            "scope": marker
                        });
                        markerLayer.addMarker(marker);
                    }
                }
            }
        }

        function bufferprocessFailed(e) {
            alert(e.error.errorMsg);
        }

        //激活添加地物
        function activateAddFeature() {
//先清除上次的显示结果
            EMvectorLayer.removeAllFeatures();
            clearAllDeactivate();
            EMdrawPolygon.activate();
        }
        //执行添加地物
        function addFeatureCompleted(drawGeometryArgs) {
            EMdrawPolygon.deactivate();
            var geometry = drawGeometryArgs.feature.geometry,
                feature = new SuperMap.Feature.Vector();
            feature.geometry = drawGeometryArgs.feature.geometry,
                feature.style = EMstyle;
            EMvectorLayer.addFeatures(feature);

            geometry.id = "100000";
            var editFeatureParameter,
                editFeatureService,
                features = {
                    fieldNames:[],
                    fieldValues:[],
                    geometry:geometry
                };
            editFeatureParameter = new SuperMap.REST.EditFeaturesParameters({
                features: [features],
                editType: SuperMap.REST.EditType.ADD,
                returnContent:false
            });
            editFeatureService = new SuperMap.REST.EditFeaturesService(url4, {
                eventListeners: {
                    "processCompleted": addFeaturesProcessCompleted,
                    "processFailed": processFailed
                }
            });
            editFeatureService.processAsync(editFeatureParameter);
        }
        //添加地物成功
        function addFeaturesProcessCompleted(editFeaturesEventArgs) {
            var addResultIds = editFeaturesEventArgs.result.IDs,
                resourceInfo = editFeaturesEventArgs.result.resourceInfo;
            if(addResultIds === null && resourceInfo === null) return;

            if((addResultIds && addResultIds.length > 0) || (resourceInfo && resourceInfo.succeed)) {
                alert("新增地物成功");
                EMvectorLayer.removeAllFeatures();
//重新加载图层
                layer.redraw();
            }else {
                alert("新增地物失败");
            }
        }
        function processFailed(e) {
            alert(e.error.errorMsg);
        }
        //激活选择地物
        function activateSelectedFeature() {
            EMvectorLayer.removeAllFeatures();
            clearAllDeactivate();
            EMdrawPoint.activate();
        }
        //执行选择地物
        function selectedFeatureCompleted(drawGeometryArgs) {
            EMdrawPoint.deactivate();
            var getFeaturesByGeometryParams,
                getFeaturesByGeometryService,
                geometry = drawGeometryArgs.feature.geometry;
            getFeaturesByGeometryParams = new SuperMap.REST.GetFeaturesByGeometryParameters({
                datasetNames: ["Jingjin:Landuse_R"],
                spatialQueryMode: SuperMap.REST.SpatialQueryMode.INTERSECT,
                geometry: geometry
            });
            getFeaturesByGeometryService = new SuperMap.REST.GetFeaturesByGeometryService(url5, {
                eventListeners: {
                    "processCompleted": selectedFeatureProcessCompleted,
                    "processFailed": processFailed
                }
            });
            getFeaturesByGeometryService.processAsync(getFeaturesByGeometryParams);
        }
        //选择地物完成
        function selectedFeatureProcessCompleted(getFeaturesEventArgs) {
            var features,
                feature,
                i, len,
                originFeatures = getFeaturesEventArgs.originResult.features,
                result = getFeaturesEventArgs.result;
            EMvectorLayer.removeAllFeatures();
            if(originFeatures === null || originFeatures.length === 0) {
                alert("查询地物为空");
                return;
            }
            ids = new Array();
//将当前选择的地物的ID保存起来，以备删除地物使用,并在编辑地物中使之为null，以免编辑地物后在不选择地物时将所编辑的地物删除
            for(i = 0, len = originFeatures.length; i < len; i++) {
                ids.push(originFeatures[i].ID);
            }
            if (result && result.features) {
                features = result.features;
                for (var j=0, len = features.length; j<len; j++) {
                    feature = features[j];
                    feature.style = EMstyle;
                    EMvectorLayer.addFeatures(feature);
                }
            }
        }
        //激活编辑地物
        function editselectedFeature() {
            clearAllDeactivate();
            if(ids==null){
                alert("请先选择地物");
            }
            else{
                modifyFeature.activate();
            }

        }
        //执行地物编辑
        function editFeatureCompleted(event) {
            modifyFeature.deactivate();
            var editFeatureParameter,
                editFeatureService,
                features,
                attributes,
                feature = event.feature;

            attributes = feature.attributes;
            var attrNames = [];
            var attrValues = [];
            for(var attr in attributes) {
                attrNames.push(attr);
                attrValues.push(attributes[attr]);
            }
            features = {
                fieldNames:attrNames,
                fieldValues:attrValues,
                geometry:event.feature.geometry
            };
            features.geometry.id = feature.fid;
            editFeatureParameter = new SuperMap.REST.EditFeaturesParameters({
                features: [features],
                editType: SuperMap.REST.EditType.UPDATE
            });
            editFeatureService = new SuperMap.REST.EditFeaturesService(url4, {
                eventListeners: {
                    "processCompleted": updateFeaturesProcessCompleted,
                    "processFailed": processFailed
                }
            });
            editFeatureService.processAsync(editFeatureParameter);
        }
        //更新地物完成
        function updateFeaturesProcessCompleted(editFeaturesEventArgs) {
            if(editFeaturesEventArgs.result.resourceInfo.succeed) {
                alert("更新地物成功");
//重新加载图层
                EMvectorLayer.removeAllFeatures();
                //layer.redraw();
                layerJingjing.redraw();
//使Ids为空，以免编辑地物后在不选择地物时将所编辑的地物删除
                ids=null;
            }
            else {
                alert("更新地物失败");
            }
        }
        //删除选中地物
        function deleteSelectedFeature() {
            clearAllDeactivate();
            if(ids==null)
            {
                alert("请先选择地物");
            }
            else{
                var editFeatureParameter,
                    editFeatureService;
                editFeatureParameter = new SuperMap.REST.EditFeaturesParameters({
                    IDs: ids,
                    editType: SuperMap.REST.EditType.DELETE
                });
                editFeatureService = new SuperMap.REST.EditFeaturesService(url4, {
                    eventListeners: {
                        "processCompleted": deleteFeaturesProcessCompleted,
                        "processFailed": processFailed
                    }
                });
                editFeatureService.processAsync(editFeatureParameter);
            }

        }
        //删除地物完成
        function deleteFeaturesProcessCompleted(editFeaturesEventArgs) {
            if(editFeaturesEventArgs.result.resourceInfo.succeed) {
                alert("删除地物成功");
//重新加载图层
                EMvectorLayer.removeAllFeatures();
                layerJingjing.redraw();
            }
            else {
                alert("删除地物失败");
            }
        }
        function clearAllDeactivate() {
            modifyFeature.deactivate();
            EMdrawPoint.deactivate();
            EMdrawPolygon.deactivate();
        }

        //点查询
        function drawPointCompleted(drawGeometryArgs) {
            var feature = new SuperMap.Feature.Vector();
            feature.geometry = drawGeometryArgs.feature.geometry,
                feature.style = drawpointstyle;
            vectorLayer.addFeatures(feature);
            console.log("点查询");
            var queryParam, queryByGeometryParameters, queryService;
            queryParam = new SuperMap.REST.FilterParameter({name: "省界_region@privances"});
            queryByGeometryParameters = new SuperMap.REST.QueryByGeometryParameters({
                queryParams: [queryParam],
                geometry: drawGeometryArgs.feature.geometry,
                spatialQueryMode: SuperMap.REST.SpatialQueryMode.INTERSECT
            });
            queryService = new SuperMap.REST.QueryByGeometryService(url, {
                eventListeners: {
                    "processCompleted": drawPointprocessCompleted,
                    "processFailed": drawPointprocessFailed
                }
            });
            queryService.processAsync(queryByGeometryParameters);
        }
        function drawPointprocessCompleted(queryEventArgs) {
            drawPoint.deactivate();
            var i, j, result = queryEventArgs.result;
            console.log("点查询完成");
            if (result && result.recordsets) {
                console.log("查询结果。。。。。。");
                for (i=0, recordsets=result.recordsets, len=recordsets.length; i<len; i++) {
                    console.log("长度："+len);
                    if (recordsets[i].features) {

                        for (j=0; j<recordsets[i].features.length; j++) {
                            console.log("对象编号+"+j);
                            var feature = recordsets[i].features[j];
                            feature.style = drawpointstyle;
                            //vectorLayer.addFeatures(feature);
                            console.log(result.recordsets[i].features[j].attributes.NAME);
                            getFeaturesBySQL(result.recordsets[i].features[j].attributes.NAME);
                        }
                    }

                }
            }
        }
        function drawPointprocessFailed(e) {
            alert(e.error.errorMsg);
        }

        function getFeaturesBySQL(name) {
            vectorLayer.removeAllFeatures();

            var getFeatureParam, getFeatureBySQLService, getFeatureBySQLParams;

            //根据输入内容查询
            var provincenameSql ="NAME like '%"+name+"%'";

            getFeatureParam = new SuperMap.REST.FilterParameter({
                name: "省界_region@privances",
                attributeFilter: provincenameSql
            });
            getFeatureBySQLParams = new SuperMap.REST.GetFeaturesBySQLParameters({
                queryParameter: getFeatureParam,
                datasetNames: ["privances:省界_region"],
            });
            getFeatureBySQLService = new SuperMap.REST.GetFeaturesBySQLService(url2, {
                eventListeners: {"processCompleted": SQLprocessCompleted, "processFailed": SQLprocessFailed}});

            getFeatureBySQLService.processAsync(getFeatureBySQLParams);
        }
        var editfeature;
        function SQLprocessCompleted(getFeaturesEventArgs) {
            var i, len, features, feature, result = getFeaturesEventArgs.result;
            if (result && result.features) {
                features = result.features;
                for (i=0, len=features.length; i<len; i++) {
                    feature = features[i];
                    console.log(feature);
                    editfeature = feature;
                    feature.style = drawstyle;
                    vectorLayer.addFeatures(feature);
                    console.log("名称："+features[i].attributes.NAME);
                    console.log("编号："+features[i].attributes.KIND);
                    document.getElementById("sqlname").value=features[i].attributes.NAME;
                }
            }
        }
        function SQLprocessFailed(e) {
            alert(e.error.errorMsg);
        }
        //画点
        function drawpoint() {
            //先清除上次的显示结果
            clearFeatures();
            drawPoint.activate();
        }
        function  savesql() {
            let editFeatureParameter,editFeatureService,feature,attributes,features,newname = document.getElementById("sqlname").value;
            feature = editfeature;
            attributes = feature.attributes;
            let attrNames = [];
            let attrValues = [];
            for(let attr in attributes) {
                attrNames.push(attr);
                attrValues.push(attributes[attr]);
            }
            features = {
                fieldNames:attrNames,
                fieldValues:attrValues,
                geometry:feature.geometry
            };
            features.fieldValues[10] = newname;
            features.geometry.id = editfeature.fid;

            console.log(features);
            // startedit(features);

            editFeatureParameter = new SuperMap.REST.EditFeaturesParameters({
                features: [features],
                editType: SuperMap.REST.EditType.UPDATE
            });
            editFeatureService = new SuperMap.REST.EditFeaturesService(url6, {
                eventListeners: {
                    "processCompleted": sqlupdateFeaturesProcessCompleted,
                    "processFailed": processFailed
                }
            });
            editFeatureService.processAsync(editFeatureParameter);
        }

        function startedit(features){
            let editFeatureParameter,editFeatureService;
            editFeatureParameter = new SuperMap.REST.EditFeaturesParameters({
                features: [features],
                editType: SuperMap.REST.EditType.UPDATE
            });
            editFeatureService = new SuperMap.REST.EditFeaturesService(url2, {
                eventListeners: {
                    "processCompleted": sqlupdateFeaturesProcessCompleted,
                    "processFailed": processFailed
                }
            });
            editFeatureService.processAsync(editFeatureParameter);
        }
        //更新地物完成
        function sqlupdateFeaturesProcessCompleted(editFeaturesEventArgs) {
            if(editFeaturesEventArgs.result.resourceInfo.succeed) {
                alert("更新地物成功");
                //重新加载图层
                vectorLayer.removeAllFeatures();
                layer.redraw();
            }
            else {
                alert("更新地物失败");
            }
        }
        function processFailed(e) {
            alert(e.error.errorMsg);
        }

    </script>
</head>

<body class="mdui-drawer-body-left mdui-appbar-with-toolbar mdui-theme-primary-indigo"onLoad = "init()">
<!-- 头部 -->
<header class="mdui-appbar mdui-appbar-fixed" id="content-header">
    <div class="mdui-toolbar mdui-color-theme">
        <span class="mdui-btn mdui-btn-icon mdui-ripple mdui-ripple-white" mdui-drawer="{target: '#content-drawer', swipe: true}"><i class="mdui-icon material-icons">menu</i></span>
        <a href="" class="mdui-typo-headline mdui-hidden-xs">WebGis实验室</a>
        <a href="" class="mdui-typo-title">地图</a>
        <div class="mdui-toolbar-spacer"></div>
        <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
        <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">refresh</i></a>-->
        <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">more_vert</i></a>-->
    </div>
</header>

<!-- 侧边栏 -->
<div class="mdui-drawer" id="content-drawer">

    <ul class="mdui-list"mdui-collapse="{accordion: true}">
    <li class="mdui-subheader">空间查询</li>
        <li class="mdui-collapse-item">
            <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
                <i class="mdui-list-item-icon mdui-icon material-icons">find_in_page</i>
                <div class="mdui-list-item-content">名称查询</div>
                <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
            </div>
            <ul class="mdui-collapse-item-body mdui-list mdui-list-dense">
                <li class=" mdui-ripple">
                    <input id="provincename" class="mdui-list-item mdui-textfield-input" type="text" placeholder="省会名称"/>
                </li>
                <li class="mdui-list-item mdui-ripple">
                    <div class="mdui-list-item-content" onclick="queryBySQL()">开始查询</div>

                </li>
            </ul>
        </li>

        <li class="mdui-collapse-item">
            <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
                <i class="mdui-list-item-icon mdui-icon material-icons">device_hub</i>
                <div class="mdui-list-item-content">几何查询</div>
                <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
            </div>
            <ul class="mdui-collapse-item-body mdui-list mdui-list-dense">
                <li class="mdui-list-item mdui-ripple" onclick="drawGeometry5()">矩形查询</li>
                <li class="mdui-list-item mdui-ripple" onclick="drawGeometry1()">圆形查询</li>
                <li class="mdui-list-item mdui-ripple" onclick="drawGeometry2()">多边形查询</li>
            </ul>
        </li>
        <li class="mdui-collapse-item">
            <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
                <i class="mdui-list-item-icon mdui-icon material-icons">open_with</i>
                <div class="mdui-list-item-content">缓冲查询</div>
                <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
            </div>
            <ul class="mdui-collapse-item-body mdui-list mdui-list-dense">
                <input id="buffernum" class="mdui-list-item mdui-textfield-input" type="text" placeholder="缓冲区大小"/>
                <li class="mdui-list-item mdui-ripple" onclick="bufferdrawPointGeometry()">点查询</li>
                <li class="mdui-list-item mdui-ripple" onclick="bufferdrawLineGeometry()">线查询</li>
                <li class="mdui-list-item mdui-ripple" onclick="bufferdrawPolygonGeometry()">面查询</li>
            </ul>
        </li>


        <li class="mdui-subheader">空间量算</li>
        <li class="mdui-collapse-item">
            <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
                <i class="mdui-list-item-icon mdui-icon material-icons">domain</i>
                <div class="mdui-list-item-content">空间量算</div>
                <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
            </div>
            <ul class="mdui-collapse-item-body mdui-list mdui-list-dense">
                <li class="mdui-list-item mdui-ripple" onclick="LineMeasure()">距离量算</li>
                <li class="mdui-list-item mdui-ripple" onclick="areaMeasure()">面积量算</li>
            </ul>
        </li>

        <li class="mdui-subheader">空间编辑</li>
        <li class="mdui-collapse-item">
            <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
                <i class="mdui-list-item-icon mdui-icon material-icons">edit</i>
                <div class="mdui-list-item-content">地物编辑</div>
                <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
            </div>
            <ul class="mdui-collapse-item-body mdui-list mdui-list-dense">
                <input id="sqlname" class="mdui-list-item mdui-textfield-input" type="text" placeholder="查询名称"/>
                <li class="mdui-list-item mdui-ripple" onclick="drawpoint()">数据编辑</li>
                <li class="mdui-list-item mdui-ripple" onclick="savesql()">保存编辑</li>
                <li class="mdui-list-item mdui-ripple" onclick="activateAddFeature()">新增地物</li>
                <li class="mdui-list-item mdui-ripple" onclick="activateSelectedFeature()">选择地物</li>
                <li class="mdui-list-item mdui-ripple" onclick="editselectedFeature()">编辑地物</li>
                <li class="mdui-list-item mdui-ripple" onclick="deleteSelectedFeature()">删除地物</li>
            </ul>
        </li>
        <li class="mdui-list-item mdui-ripple">
            <i class="mdui-list-item-icon mdui-icon material-icons">delete</i>
            <div class="mdui-list-item-content" onclick="clearFeatures()">全部清除</div>
        </li>

    </ul>
</div>

<!-- 内容 -->
<div class="mdui-container-fluid" id="content-main">
    <div id = "map"></div>
</div>

<!-- 尾部 -->
<div class="mdui-color-theme" id="content-footer">Powered by SuperMap iServer 9D(2019)(9.1.0-win64) © Copyright 宋天伦·空信1601·201616060110·WebGis实验室</div>
</body>
</html>
